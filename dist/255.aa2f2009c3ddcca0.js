"use strict";(self.webpackChunkmoveo_task_client=self.webpackChunkmoveo_task_client||[]).push([[255],{5255:(G,f,e)=>{e.r(f),e.d(f,{AuthenticationModule:()=>k});var g=e(1791),r=e(9653),l=(()=>{return(n=l||(l={})).login="[Authentication] Login",n.loginSuccess="[Authentication] Login Success",n.loginFail="[Authentication] Login Fail",l;var n})();const v=(0,r.PH)(l.login,(0,r.Ky)()),y=(0,r.PH)(l.loginSuccess,(0,r.Ky)()),I=(0,r.PH)(l.loginFail);var t=e(4650),L=e(5643),u=e(4006),p=e(9549),F=e(4144),M=e(4859);let C=(()=>{class n{constructor(o){this.fb=o,this.studentLogin=!1,this.loginSubmit=new t.vpe,this.loginForm=this.fb.group({username:["",[u.kI.required]],password:["",[u.kI.required]]})}onLoginAttempt(){this.loginForm.valid&&this.loginSubmit.emit({...this.loginForm.value,studentLogin:this.studentLogin})}}return n.\u0275fac=function(o){return new(o||n)(t.Y36(u.qu))},n.\u0275cmp=t.Xpm({type:n,selectors:[["moveo-task-login"]],inputs:{studentLogin:"studentLogin"},outputs:{loginSubmit:"loginSubmit"},decls:18,vars:2,consts:[[1,"page-wrapper"],[1,"login-form-wrapper",3,"formGroup","ngSubmit"],[1,"login-logo"],["appearance","fill"],["matInput","","formControlName","username"],["type","password","matInput","","formControlName","password"],["mat-raised-button","","type","submit","color","primary",1,"login-button"]],template:function(o,a){1&o&&(t.TgZ(0,"div",0)(1,"form",1),t.NdJ("ngSubmit",function(){return a.onLoginAttempt()}),t.TgZ(2,"div",2),t._uU(3),t.qZA(),t.TgZ(4,"mat-form-field",3)(5,"mat-label"),t._uU(6,"Username"),t.qZA(),t._UZ(7,"input",4),t.TgZ(8,"mat-error"),t._uU(9,"Username field must not be empty"),t.qZA()(),t.TgZ(10,"mat-form-field",3)(11,"mat-label"),t._uU(12,"Password"),t.qZA(),t._UZ(13,"input",5),t.TgZ(14,"mat-error"),t._uU(15,"Password field must not be empty"),t.qZA()(),t.TgZ(16,"button",6),t._uU(17,"Login"),t.qZA()()()),2&o&&(t.xp6(1),t.Q6J("formGroup",a.loginForm),t.xp6(2),t.hij("Moveo Task - ",!0===a.studentLogin?"Student Login":"Mentor Login",""))},dependencies:[p.TO,p.KE,p.hX,F.Nt,M.lW,u._Y,u.Fj,u.JJ,u.JL,u.sg,u.u],styles:[".page-wrapper[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center}.page-wrapper[_ngcontent-%COMP%]   .login-form-wrapper[_ngcontent-%COMP%]{display:flex;flex-direction:column;width:300px}.page-wrapper[_ngcontent-%COMP%]   .login-form-wrapper[_ngcontent-%COMP%]   .login-logo[_ngcontent-%COMP%]{font-size:40px;margin-bottom:70px;text-align:center;color:#3f51b5;align-self:center;width:500px}.page-wrapper[_ngcontent-%COMP%]   .login-form-wrapper[_ngcontent-%COMP%]   .login-button[_ngcontent-%COMP%]{margin-top:30px}"]}),n})(),m=(()=>{class n{constructor(o,a,c){this.store=o,this.activatedRoute=a,this.authService=c,this.studentLogin=!1,this.studentId=null,this.uuid=null,this.codeBlockId=null}ngOnInit(){this.authService.clearAuthStorage(),this.studentLogin=this.activatedRoute.snapshot.data.studentLogin,this.studentId=this.activatedRoute.snapshot.params.studentId,this.uuid=this.activatedRoute.snapshot.params.uuid,this.codeBlockId=this.activatedRoute.snapshot.params.codeBlockId}onLoginSubmit(o){this.store.dispatch(v({payload:{username:o.username,password:o.password,studentId:this.studentId,uuid:this.uuid,codeBlockId:this.codeBlockId}}))}}return n.\u0275fac=function(o){return new(o||n)(t.Y36(r.yh),t.Y36(g.gz),t.Y36(L.e))},n.\u0275cmp=t.Xpm({type:n,selectors:[["moveo-task-login-container"]],decls:1,vars:1,consts:[[3,"studentLogin","loginSubmit"]],template:function(o,a){1&o&&(t.TgZ(0,"moveo-task-login",0),t.NdJ("loginSubmit",function(h){return a.onLoginSubmit(h)}),t.qZA()),2&o&&t.Q6J("studentLogin",a.studentLogin)},dependencies:[C],encapsulation:2}),n})();const Z=[{path:"mentor-login",component:m,data:{studentLogin:!1}},{path:"student-login/:uuid/:studentId/:codeBlockId",component:m,data:{studentLogin:!0}}];let B=(()=>{class n{}return n.\u0275fac=function(o){return new(o||n)},n.\u0275mod=t.oAB({type:n}),n.\u0275inj=t.cJS({imports:[g.Bz.forChild(Z),g.Bz]}),n})();var T=e(6907),A=e(8579),d=e(2260),b=e(6129),P=e(4004),O=e(262),x=e(9646),U=e(8505),J=e(5153),w=e(7009);let R=(()=>{class n{constructor(o,a,c,h){this.actions$=o,this.authService=a,this.router=c,this.snackBar=h,this.login$=(0,d.GW)(()=>this.actions$.pipe((0,d.l4)(v),(0,b.z)(i=>this.authService.loginAttempt(i.payload.username,i.payload.password).pipe((0,P.U)(S=>y({payload:{user:S,studentId:i.payload.studentId,uuid:i.payload.uuid,codeBlockId:i.payload.codeBlockId}})),(0,O.K)(S=>(0,x.of)(I())))))),this.loginSuccess$=(0,d.GW)(()=>this.actions$.pipe((0,d.l4)(y),(0,U.b)(i=>{i.payload.studentId?i.payload.user.id===Number(i.payload.studentId)?(this.authService.userAuthenticated(i.payload.user),this.router.navigate(["/session",i.payload.uuid,i.payload.studentId,i.payload.codeBlockId])):this.snackBar.open("Login Failed! You are trying to access other user's session!",void 0,{duration:3e3}):i.payload.user.userType===J.F.MENTOR?(this.authService.userAuthenticated(i.payload.user),this.router.navigate(["/lobby"])):this.snackBar.open("Login Failed! Mentor login is not meant for students!",void 0,{duration:3e3})})),{dispatch:!1})}}return n.\u0275fac=function(o){return new(o||n)(t.LFG(d.eX),t.LFG(L.e),t.LFG(g.F0),t.LFG(w.ux))},n.\u0275prov=t.Yz7({token:n,factory:n.\u0275fac}),n})(),k=(()=>{class n{}return n.\u0275fac=function(o){return new(o||n)},n.\u0275mod=t.oAB({type:n}),n.\u0275inj=t.cJS({imports:[T.m,B,r.Aw.forFeature(A.KJ,A.VC),d.sQ.forFeature([R])]}),n})()}}]);